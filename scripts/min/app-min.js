!function(){"use strict";angular.module("brandedPalette",["ngAnimate","ui.router","ngLodash","ngDialog","app.controllers","parse.services","app.services","LocalStorageModule"]).run(["$rootScope","$state","$templateCache","ParseService",function(t,e,r,a){t.$on("$stateChangeSuccess",function(e,r){t.$emit("stateChange",r)}),t.$on("$stateChangeError",function(t,e){console.log(t)}),r.put("imageModal","views/Gallery/modal.html")}]).config(["$stateProvider","$urlRouterProvider","$httpProvider","ngDialogProvider","localStorageServiceProvider",function(t,e,r,a,n){n.setPrefix("storage").setNotify(!0,!0),r.defaults.useXDomain=!0,delete r.defaults.headers.common["X-Requested-With"],a.setDefaults({className:"ngdialog-theme-default",plain:!0,showClose:!0,closeByDocument:!0,closeByEscape:!0}),t.state("app",{url:"/","abstract":!0,resolve:{cart:function(t){t.setRootScopeCart()},brands:function(t){var e=[];return t.all().then(function(t){return angular.forEach(t,function(t){var r={};r.data=t.attributes,r.id=t.id,e.push(r)}),e})},categories:function(t){var e=[];return t.all().then(function(t){return angular.forEach(t,function(t){var r={};r.data=t.attributes,r.id=t.id,e.push(r)}),e})},products:function(t){var e=[];return t.all().then(function(t){return angular.forEach(t,function(t){var r={};r.data=t.attributes,r.id=t.id,e.push(r)}),e})}},views:{menu:{templateUrl:"views/menu.html",controller:function(t,e,r,a,n,o){console.log(o.cart),t.currentState=e.current,o.$on("stateChange",function(e,a){console.log("hide popover"),t["open_"+t.activeMenuItem]=!1,r.defer(function(){t.currentState=a,t.$apply(),console.log(a)})}),o.$watch("cart",function(t){console.log(t)}),t.menuItems=[],t.openPopover=function(e){t["open_"+t.activeMenuItem]=!1,t.activeMenuItem=e,t["open_"+e]=!0,event.stopPropagation()},t.closePopover=function(){t["open_"+t.activeMenuItem]=!1},t.goTo=function(t,r){console.log(t,r),null!=r?e.transitionTo(t.subRoute,{id:r}):e.transitionTo(t.name)},t.getMenu=function(){var r=JSON.parse(angular.toJson(e.get()));angular.forEach(r,function(e){if(!e.hasOwnProperty("abstract")&&!e.data.hasOwnProperty("abstract")){var r={label:e.data.label,url:e.url,name:e.name};"categories"===e.url?(r.hasSubs=!0,r.sub=a,r.subRoute="app.category"):"products"===e.url?(r.hasSubs=!0,r.sub=n,r.subRoute="app.product"):r.hasSubs=!1,t.menuItems.push(r)}})},t.getMenu()}}}}).state("app.home",{url:"home",views:{app:{templateUrl:"views/home.html",controller:function(t,e){console.log(e),t.brands=e}}},data:{label:"Home"}}).state("app.categories",{url:"categories",views:{app:{templateUrl:"views/categories.html",controller:function(t,e,r){console.log(e),t.categories=e,t.zoomToCategory=function(t){r.go("app.category",{id:t.id})}}}},data:{label:"Categories"}}).state("app.category",{url:"categories/:id",views:{app:{templateUrl:"views/category.html",resolve:{category:function(t,e){return t.getById(e.id).then(function(t){return t[0]})},products:function(t,e){var r=[];return t.getInCategory(e.id).then(function(t){return angular.forEach(t,function(t){var e={};e.data=t.attributes,e.id=t.id,r.push(e)}),r})}},controller:function(t,e,r){t.products=e,t.category=r,console.log(r)}}},data:{"abstract":!0}}).state("app.products",{url:"products",views:{app:{templateUrl:"views/products.html",controller:function(t,e,r){t.products=e,t.brands=r}}},data:{label:"Products"}}).state("app.product",{url:"products/:id/:brandId",views:{app:{templateUrl:"views/product.html",resolve:{product:function(t,e){return e.getById(t.id).then(function(t){return t[0]})},category:function(t,e){return e.getById(t.category.id).then(function(t){return t[0]})},productImages:function(t,e,r){var a=[];return e.getAllProductImagesForAllBrands(t.id).then(function(e){return angular.forEach(e,function(e){var r={};r.brandId=e.attributes.brand.id,r.id=e.id,r.name=t.attributes.name,r.price=t.attributes.price,r.image=e.attributes.image._url,a.push(r)}),a})},productsWithBrandInfo:function(t,e){var r=[];return angular.forEach(t,function(t){var a=t;return e.getById(t.brandId).then(function(t){a.brandName=t[0].attributes.name,r.push(a)});return r})},selectedBrandIndex:function(t,e,r){return e.brandId?r.findIndex(t,{brandId:e.brandId}):0}},controller:function(t,e,r,a,n,o){t.product=e,t.category=r,t.brandDropdown={selected:a[n],brands:a},t.addToCart=function(e){if(0==a.length){var r={};r.id=t.product.id,r.name=t.product.attributes.name,r.price=t.product.attributes.price,r.quantity=1e3,r.brandName="N/A",r.image="img/no_product_image.svg",o.addToCart(r)}else e.quantity=1e3,e.image||(e.image="img/no_product_image.svg"),o.addToCart(e)}}}},data:{"abstract":!0}}).state("app.checkout",{url:"checkout",views:{app:{templateUrl:"views/checkout.html",controller:function(t,e){t.total=0,angular.forEach(e.cart,function(e){t.total+=e.price*e.quantity})}}},data:{label:"Account"}}),e.otherwise("/home")}]).controller("FormController",["$scope","$http",function(t,e){t.input={},t.submitForm=function(){var r=t.form.$valid;0==r?t.invalidForm="Form is invalid":e({method:"POST",url:"mailer.php",data:t.input,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){e.errors?(t.errorName=e.errors.name,t.errorEmail=e.errors.email,t.errorMessage=e.errors.message):t.successMessage=e.successMessage})}}]).filter("range",function(){return function(t,e){e=parseInt(e);for(var r=0;e>r;r++)t.push(r);return t}}).filter("capitalize",function(){return function(t,e){return t?t.replace(/([^\W_]+[^\s-]*) */g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}):""}}).directive("ngBackground",function(){return function(t,e,r){r.$observe("ngBackground",function(t,r){t&&e.css({"background-image":"url("+t+")","background-size":"cover"})},!0)}})}();